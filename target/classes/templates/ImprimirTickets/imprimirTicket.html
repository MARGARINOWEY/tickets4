<!DOCTYPE html>
<html lang="en" class="loading">

<head th:fragment="head">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta name="description"
        content="Convex admin is super flexible, powerful, clean &amp; modern responsive bootstrap 4 admin template with unlimited possibilities.">
    <meta name="keywords"
        content="admin template, Convex admin template, dashboard template, flat admin template, responsive admin template, web app">
    <title>Venta de Tickets</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <link
        href="https://fonts.googleapis.com/css?family=Rubik:300,400,500,700,900%7CMontserrat:300,400,500,600,700,800,900"
        rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Mouse+Memoirs&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="../../../../../app-assets/fonts/feather/style.min.css">

    <link rel="stylesheet" type="text/css" href="../../../../../app-assets/fonts/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="../../../../../app-assets/css/app.css">
    <style>
        .contenido {
            color: white;
            font-family: 'Mouse Memoirs', sans-serif;
            font-size: 20px;
        }

        .contenidoM {
            color: white;
            font-family: 'Mouse Memoirs', sans-serif;
            font-size: 130px;
            margin-bottom: 0px;
            line-height: 77%;
        }

        .titulo2 {
            color: gold;
            font-family: 'Mouse Memoirs', sans-serif;
            font-size: 22.5px;
            margin-bottom: 0px;
        }

        .titulo1 {
            color: white;
            font-family: 'Mouse Memoirs', sans-serif;
            font-size: 22.5px;
            margin-bottom: 0px;
        }
    </style>

</head>

<body>
    <!-- ////////////////////////////////////////////////////////////////////////////-->
    <div>
        <div class="main-panel">
            <div class="main-content">
                <div class="row">
                    <div class="col-12">
                        <button style="width: 100%;" class="btn btn-round btn-lg btn-dark mr-1"
                            onclick="downloadPdf()">
                            <i class="fa fa-download"></i>
                            Descargar en PDF
                        </button>
                        <button style="width: 100%;" class="btn btn-round btn-lg btn-dark mr-1"
                            onclick="downloadImage()">
                            <i class="fa fa-download"></i>
                            Descargar en Imagen
                        </button>
                    </div>
                </div>
                <div class="content" id="contenedorImprimir" style="min-width: 1500px;">
                    <div class="container-fluid">
                        <section id="alert">
                            <!--Alert States Starts-->
                            <div class="row match-height">
                                <div class="col-12">
                                    <div class="card"
                                        style="border-style: dashed; border-width: 4px; background-image: linear-gradient(to right, #003d99, #0043b2, #004acc, #004fe5, #1654ff);">
                                        <div class="card-body">
                                            <div class="card-block" style="padding-bottom: 0px;padding-top: 0px;">
                                                <div class="row align-items-center">
                                                    <div class="col-2">
                                                        <img src="../../../../../uploads/img1.png" style="width: 100%; height: 75%;" alt="">
                                                    </div>
                                                    <div class="col-2">
                                                        <div class="row">
                                                            <div class="col-12">
                                                                <h6 th:text="${'ID: '+ticket.id_ticket}"
                                                                    class="titulo1">ID: 164240</h6>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-12">
                                                                <h6 class="titulo2">NO. DE MESA:</h6>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-12">
                                                                <h3 th:text="${ticket.sector.desc_sector}"
                                                                    class="contenidoM">15</h3>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-12">
                                                                <h6 class="titulo2">NOMBRE DEL COMPRADOR:</h6>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-12">
                                                                <p th:text="${ticket.compra.usuario.persona.nombre+' '+ticket.compra.usuario.persona.apellido_p}"
                                                                    class="contenido">CRISTIAN GARCIA QUISPE</p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="col-4">
                                                        <img src="../../../../../uploads/img3.png"
                                                            style="width: 100% ; height: 75%;" alt="">
                                                    </div>
                                                    <div class="col-2">
                                                        <div style='text-align: right;'>
                                                            <div id="qrcode"></div>
                                                            <!-- <img style="width: 100%; height: 75%;" class="qr"
                                                                alt='Barcode Generator TEC-IT'
                                                                
                                                                th:src="${'https://barcode.tec-it.com/barcode.ashx?data='+ticket.crypt+'&code=MobileQRCode&eclevel=L&modulewidth=1.5'}" /> -->
                                                            <!-- <img style="width: 100%; height: 75%;" class="qr" alt='Barcode Generator TEC-IT' th:src="${'https://barcode.tec-it.com/barcode.ashx?data=https%3A%2F%2Ftouch-and-treat.up.railway.app%3A8080%2FticketEscaneado%2F'+ticket.crypt+'&code=MobileQRCode&eclevel=L&modulewidth=1.5'}"/> -->
                                                            <!--<img alt='Barcode Generator TEC-IT'
                                                                th:src="${'https://barcode.tec-it.com/barcode.ashx?data='+t.cod+'&code=Code25IL&eclevel=M'}"/>
                                                            -->
                                                        </div>
                                                    </div>
                                                    <div class="col-2">
                                                        <img src="../../../../../uploads/img2.png"
                                                            style="width: 100%; height: 200px;" alt="">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </section>
                    </div>
                </div>
                
                <input type="hidden" th:value="${ticket.crypt}" id="miInput" />
            </div>
        </div>
    </div>
    <!-- <script>
            window.onload = function() {
            var css = '@page { size: landscape; margin: 0;} body {-webkit-print-color-adjust: exact;}',
            head = document.head || document.getElementsByTagName('head')[0],
            style = document.createElement('style');

            style.type = 'text/css';
            style.media = 'print';

            if (style.styleSheet){
            style.styleSheet.cssText = css;
            } else {
            style.appendChild(document.createTextNode(css));
            }

            head.appendChild(style);

            window.print();
        }
        </script> -->
    <script src="../../../../app-assets/js/html2canvas.js"></script>
    <script src="../../../../app-assets/js/jsPdf.js"></script>
    <script src="../../../../app-assets/js/qrCode.js"></script>
    <script type="text/javascript">
        var inputElement = document.getElementById('miInput').value;

        var qrcode = new QRCode(document.getElementById("qrcode"), {
        text: inputElement,
        width: 175,
        height: 175
        });
    </script>
    <script>
        function downloadPdf() {
            html2canvas(document.querySelector("#contenedorImprimir")).then(canvas => {

                const imgData = canvas.toDataURL('image/png');
                const pdf = new jsPDF({
                    orientation: 'landscape',
                    unit: 'mm',
                    format: 'letter'
                });

                let imgWidth = 279.4 - 20;

                let imgHeight = (canvas.height * imgWidth) / canvas.width;

                pdf.addImage(imgData, 'PNG', 10, 10, imgWidth, imgHeight);
                pdf.save("TICKET_.pdf");

                // let link = document.createElement("a");
                // link.download = 'imagen-descargada.png';
                // link.href = canvas.toDataURL("image/jpeg", 0.8); // 80% de calidad
                // link.click();
            });
        }

        function downloadImage() {
            html2canvas(document.querySelector("#contenedorImprimir")).then(canvas => {
                let link = document.createElement("a");
                link.download = 'TICKET_.png';
                link.href = canvas.toDataURL("image/png"); // 80% de calidad
                link.click();
            });
        }

    </script>
</body>

</html>